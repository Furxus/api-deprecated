type Invite {
    code: String!
    uses: Int!
    maxUses: Int!
    createdBy: User!
    expiresAt: DateTime
    expiresTimestamp: Timestamp
    createdAt: DateTime!
    createdTimestamp: Timestamp!
}

type Server {
    id: String!
    name: String!
    nameAcronym: String!
    owner: Member!
    members: [Member]!
    channels: [Channel]!
    roles: [Role]!
    invites: [Invite]!
    createdAt: DateTime!
    createdTimestamp: Timestamp!
    updatedAt: DateTime!
    updatedTimestamp: Timestamp!
    icon: String
    description: String
}

type ServerSettings {
    id: String!
    channels: [Channel]!
    roles: [Role]!
    invites: [Invite]!
    createdAt: DateTime!
    createdTimestamp: Timestamp!
    updatedAt: DateTime!
    updatedTimestamp: Timestamp!
}

type Member {
    id: String!
    user: User!
    server: Server!
    roles: [Role]!
    permissions: [String]!
    joinedAt: DateTime!
    joinedTimestamp: Timestamp!
    updatedAt: DateTime!
    updatedTimestamp: Timestamp!
}

type Role {
    id: String!
    name: String!
    hoisted: Boolean!
    mentionable: Boolean!
    permissions: [String]!
    server: Server!
    position: Int!
    color: String
    createdAt: DateTime!
    createdTimestamp: Timestamp!
    updatedAt: DateTime!
    updatedTimestamp: Timestamp!
}

type Channel {
    id: String!
    name: String!
    server: Server!
    messages: [Message]!
    category: Channel
    children: [Channel]
    type: String!
    topic: String
    position: Int!
    nsfw: Boolean!
    createdAt: DateTime!
    createdTimestamp: Timestamp!
    updatedAt: DateTime!
    updatedTimestamp: Timestamp!
}

type Message {
    id: String!
    content: String!
    edited: Boolean!
    embeds: [MessageEmbed]!
    attachments: [MessageAttachment]!
    channel: Channel!
    member: Member!
    server: Server!
    createdAt: DateTime!
    createdTimestamp: Timestamp!
    updatedAt: DateTime!
    updatedTimestamp: Timestamp!
}

type MessageEmbed {
    title: String
    description: String
    url: String
    color: String
    timestamp: Timestamp
    author: EmbedAuthor
    footer: EmbedFooter
    image: String
}

type MessageAttachment {
    url: String!
    filename: String!
    size: Int!
    contentType: String!
}

type EmbedAuthor {
    name: String!
    url: String
    iconUrl: String
}

type EmbedFooter {
    text: String!
    iconUrl: String
}

extend type Query {
    # Server Queries
    getServer(id: String!): Server!
    getServerSettings(id: String!): ServerSettings!
    getServers: [Server]!
    getUserServers: [Server]!

    # Channel Queries
    getChannel(serverId: String!, id: String!): Channel!
    getChannels(serverId: String!, type: [String]): [Channel]!

    # Message Queries
    getMessage(serverId: String!, channelId: String!, id: String!): Message!
    getMessages(serverId: String!, channelId: String!): [Message]!

    # Member Queries
    getMember(serverId: String!, memberId: String!): Member!
    getMembers(serverId: String!): [Member]!

    # Role Queries
    getRole(serverId: String!, id: String!): Role!
    getRoles(serverId: String!): [Role]!
}

extend type Mutation {
    # Server Mutations
    createServer(name: String!, icon: Upload): Server!
    joinServer(code: String!): Server!
    leaveServer(id: String!): Server!
    deleteServer(id: String!): Server!
    updateServer(
        id: String!
        propertyNames: [String!]!
        propertyValues: [Any!]!
    ): Server!

    # Channel Mutations
    createChannel(serverId: String!, name: String!, type: String!): Channel!
    deleteChannel(serverId: String!, id: String!): Channel!
    updateChannel(
        serverId: String!
        id: String!
        propertyNames: [String!]!
        propertyValues: [Any!]!
    ): Channel!

    # Message Mutations
    createMessage(
        serverId: String!
        channelId: String!
        content: String!
    ): Message!
    deleteMessage(serverId: String!, channelId: String!, id: String!): Message!
    editMessage(
        serverId: String!
        channelId: String!
        id: String!
        content: String!
    ): Message!

    # Member Mutations
    addMember(serverId: String!, userId: String!): Member!
    removeMember(serverId: String!, userId: String!): Boolean!
    updateMember(
        serverId: String!
        userId: String!
        propertyNames: [String!]!
        propertyValues: [Any!]!
    ): Member!

    # Role Mutations
    createRole(serverId: String!, name: String!): Role!
    deleteRole(serverId: String!, id: String!): Boolean!
    updateRole(
        serverId: String!
        id: String!
        propertyNames: [String!]!
        propertyValues: [Any!]!
    ): Role!
}

extend type Subscription {
    # Server Subscriptions
    serverCreated(userId: String!): Server!
    serverJoined(userId: String!): Server!
    serverLeft(userId: String!): Server!
    serverDeleted(userId: String!): Server!

    # Channel Subscriptions
    channelCreated(serverId: String!): Channel!
    channelDeleted(serverId: String!): Channel!

    # Message Subscriptions
    messageCreated(serverId: String!, channelId: String!): Message!
    messageEdited(serverId: String!, channelId: String!): Message!
    messageDeleted(serverId: String!, channelId: String!): Message!
}
